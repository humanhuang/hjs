/*
 * @Summery: tiny mobile AMD loader
 *
 * @Author: human.hjh<halfthink@163.com>
 * @createdDate: 2014-4-29
 *
 * @issues: https://github.com/humanhuang/hjs/issues
 */
var hjs,define;!function(e,t){function n(e,t,o,c){if(e=n.getPath(e),n.cache[e])return void(console&&console.log("module "+e+" is exists!"));var a=this;a.modulename=e,a.callback=o,a.depths=n.getDeps(t,a),a.needLoadDepth=a.depths.length,a.notices=(n.noticesCache[e]||{}).notices||[],a.exports={},a.execed=!1,a.use=c,a.init()}function o(){return f++}function c(e,t){t.toString().replace(p,function(t,t,n){n&&e.push(n)})}function a(e){return"[object Array]"==Object.prototype.toString.call(e)}function i(e){return e?a(e)?e:[e]:[]}function r(e,t){if(a(e))for(var n=0;n<e.length;n++)t(e[n],n);else for(var n in e)t(e[n],n)}function s(e){return"function"==typeof e}n.prototype={init:function(){var e=this;n.cache[e.modulename]=e,e.needLoadDepth?e.loadDepths():e.complete()},complete:function(){var e=this;e.status=n.loadStatus.LOADED,e.use&&e.exec(),e.noticeModule()},loadDepths:function(){var e=this;e.status=n.loadStatus.LOADING_DEPTHS,r(e.depths,function(t){n.load(t,e.modulename)})},receiveNotice:function(){--this.needLoadDepth||this.complete()},noticeModule:function(e){var t=this;if(e){if(t.status!=n.loadStatus.LOADED)return t.notices.push(e);n.cache[e].receiveNotice()}else r(t.notices,function(e){n.cache[e].receiveNotice()}),t.notices.length=0},exec:function(){var t=this;if(!t.execed&&(t.execed=!0,s(t.callback))){var o;(o=t.callback.call(e,n.require,t.exports,t))&&(t.exports=o)}}},n.loadStatus={LOADING_DEPTHS:1,LOADED:2},n.cache={},n.noticesCache={},n.loadingSource={},n.loadedSource={},n.init=function(e){!n.cache[e]&&new n(e)},n.require=function(e){var t=n.cache[n.getPath(e)];return t.exec(),t.exports},n.load=function(o,c){function a(t){t&&(e.execScript||function(t){eval.call(e,t)})(t)}function i(t,n){var o=e.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");return o.open("GET",t,!0),o.onreadystatechange=function(){if(4===o.readyState){if(o.status>399&&o.status<600)throw new Error("Could not load: "+t+", status = "+o.status);n(o.responseText)}},o.send(null)}function r(){g||(!d.readyState||/loaded|complete/.test(d.readyState))&&(d.onload=d.onerror=d.onreadystatechange=null,n.loadedSource[l]=g=1,n.loaded(o))}var s,u;if(c){if(s=n.cache[o])return s.noticeModule(c);if(u=n.noticesCache[o])return u.notices.push(c);n.noticesCache[o]={notices:[c]}}var l=n.getFullPath(o);if(n.loadingSource[l])n.loadedSource[l]&&n.init(o);else{n.loadingSource[l]=1;var d,f,h=/\.([^?/]+)(?:\?\S+)?$/.exec(o)[1],p=/\.css(?:\?\S+)?$/.test(o),g=0,v=+navigator.userAgent.replace(/.*(?:Apple|Android)WebKit\/(\d+).*/,"$1")<536;if("js"==h)d=t.createElement("script"),d.type="text/javascript",d.src=l;else if("css"==h){if(d=t.createElement("link"),d.rel="stylesheet",d.type="text/css",d.href=l,f="onload"in d,p&&(v||!f))var S=setTimeout(function(){return d.sheet?(clearTimeout(S),r()):void setTimeout(arguments.callee)})}else i(o,function(e){if("json"==h){var t;try{t=JSON.parse(e)}catch(n){t=e}define(o,[],function(){return t})}else"script"==h?define(o,[],function(){return a(e)}):define(o,[],function(){return e})});("js"==h||"css"==h)&&(d.onload=d.onerror=d.onreadystatechange=r,d.charset=hjs.config().charset,t.getElementsByTagName("head")[0].appendChild(d))}},n.loaded=function(e){n.cache[e]||n.init(e)},n.getDeps=function(e,t){var o=[];return r(i(e),function(e){e=n.getPath(e,t),o.push(e)}),o},n.getPath=function(e,t){var n=(e.length-1,hjs.config());n.alias[e]&&(e=n.alias[e]),n.paths[e]&&(e=n.paths[e]);var o=/\.([^?/]+)(?:\?\S+)?$/.exec(e);return o||(e+=".js"),e};var u=/\/\.\//g,l=/\/[^/]+\/\.\.\//g,d=/[^:/]\/{2}/g;n.getFullPath=function(e){var t=hjs.config(),n=t.base;return n&&("/"!==n.substr(n.length-1)&&(n+="/"),e=n+e),e=e.replace(u,"/"),e=e.replace(l,"/"),e=e.replace(d,"/"),r(t.map,function(t){e=e.replace(t[0],t[1])}),e};var f=0;hjs=function(t,c){return n.cache[t]?n.cache[t].exports:void new n("_r_"+o(),t,function(){var o=[];r(i(t),function(e){o.push(n.require(e))}),s(c)&&c.apply(e,o)},!0)},hjs.version="1.0.0",hjs.module={cache:n.cache,noticesCache:n.noticesCache,loadingSource:n.loadingSource,loadedSource:n.loadedSource};var h={base:"",alias:{},paths:{},map:[],preload:[],debug:!0,charset:"utf-8"};hjs.config=function(e){return e?void r(e,function(e,t){a(e)?r(e,function(e,o){h[t].push(e),"preload"===t&&n.load(n.getPath(e))}):"object"==typeof e?r(e,function(e,n){h[t][n]=e}):h[t]=e}):h},define=function(e,t,o){"function"==typeof t&&(o=t,t=[]),t.length||c(t,o.toString()),new n(e,t,o)};var p=/"(?:\\"|[^"])*"|'(?:\\'|[^'])*'|\/\*[\S\s]*?\*\/|\/(?:\\\/|[^\/\r\n])+\/(?=[^\/])|\/\/.*|\.\s*require|(?:^|[^$])\brequire\s*\(\s*(["'])(.+?)\1\s*\)/g}(window,document);

