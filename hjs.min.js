/*
 * @Summery: tiny mobile AMD loader
 *
 * @Author: human.hjh<halfthink@163.com>
 * @createdDate: 2014-4-29
 *
 * @issues: https://github.com/humanhuang/hjs/issues
 */
var hjs,define;!function(e,t){function o(e){return"[object Array]"==Object.prototype.toString.call(e)}function n(e){return e?o(e)?e:[e]:[]}function c(e,t){if(o(e))for(var n=0;n<e.length;n++)t(e[n],n);else for(var n in e)t(e[n],n)}function a(e){return"function"==typeof e}var i=function(e,t,o,n){if(i.cache[e])return void(console&&console.log("module "+e+" is exists!"));var c=this;c.modulename=e,c.callback=o,c.depths=i.getDeps(t),c.needLoadDepth=c.depths.length,c.notices=(i.noticesCache[e]||{}).notices||[],c.exports={},c.execed=!1,c.use=n,c.init()};i.prototype={init:function(){var e=this;i.cache[e.modulename]=e,e.needLoadDepth?e.loadDepths():e.complete()},complete:function(){var e=this;e.status=i.loadStatus.LOADED,e.use&&e.exec(),e.noticeModule()},loadDepths:function(){var e=this;e.status=i.loadStatus.LOADING_DEPTHS,c(e.depths,function(t){i.load(t,e.modulename)})},receiveNotice:function(){--this.needLoadDepth||this.complete()},noticeModule:function(e){var t=this;if(e){if(t.status!=i.loadStatus.LOADED)return t.notices.push(e);i.cache[e].receiveNotice()}else c(t.notices,function(e){i.cache[e].receiveNotice()}),t.notices.length=0},exec:function(){var t=this;if(!t.execed&&(t.execed=!0,a(t.callback))){var o;(o=t.callback.call(e,i.require,t.exports,t))&&(t.exports=o)}}},i.loadStatus={LOADING_DEPTHS:1,LOADED:2},i.cache={},i.noticesCache={},i.loadingSource={},i.loadedSource={},i.mapSource={},i.init=function(e){!i.cache[e]&&new i(e)},i.require=function(e){var t=i.cache[i.getPath(e)];return t.exec(),t.exports},i.load=function(e,o){function n(){l||(!h.readyState||/loaded|complete/.test(h.readyState))&&(h.onload=h.onerror=h.onreadystatechange=null,i.loadedSource[u]=l=1,i.loaded(u))}var c,a;if(c=i.cache[e])return c.noticeModule(o);if(a=i.noticesCache[e])return a.notices.push(o);i.noticesCache[e]={notices:[o]};var r,u=i.getFullPath(e);if((r=i.mapSource[u])||(r=i.mapSource[u]=[]),r.push(e),i.loadingSource[u])i.loadedSource[u]&&i.init(e);else{i.loadingSource[u]=1;var s=/\.css$/.test(e),l=0,d=+navigator.userAgent.replace(/.*(?:Apple|Android)WebKit\/(\d+).*/,"$1")<536,h=t.createElement(s?"link":"script"),p="onload"in h;if(s?(h.rel="stylesheet",h.type="text/css",h.href=u):(h.type="text/javascript",h.src=u),h.onload=h.onerror=h.onreadystatechange=n,h.charset=hjs.config.charset,t.getElementsByTagName("head")[0].appendChild(h),s&&(d||!p))var f=setTimeout(function(){return h.sheet?(clearTimeout(f),n()):void setTimeout(arguments.callee)})}},i.loaded=function(e){var t=i.mapSource[e];c(t,function(e){i.init(e)}),t.length=0},i.getDeps=function(e){var t=[];return c(n(e),function(e){e=i.getPath(e),t.push(e),t.push.apply(t,i.getDeps(hjs.config.deps[e]))}),t},i.getPath=function(e){return e+=".js"},i.getFullPath=function(e){return e};var r=0;hjs=function(t,o){return i.cache[t]?i.cache[t].exports:void new i("_r_"+r++,t,function(){var r=[];c(n(t),function(e){r.push(i.require(e))}),a(o)&&o.apply(e,r)},!0)},hjs.version="1.0.0",hjs.module={cache:i.cache,noticesCache:i.noticesCache,loadingSource:i.loadingSource,loadedSource:i.loadedSource,mapSource:i.mapSource},hjs.config={domain:"",baseurl:"",rules:[],charset:"utf-8",deps:{},map:{}},define=function(e,t,o){e=i.getPath(e),t=t||require.config.deps[e],new i(e,t,o)}}(window,document);

