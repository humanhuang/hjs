/*
 * @Summery: tiny mobile AMD loader
 *
 * @Author: human.hjh<halfthink@163.com>
 * @createdDate: 2014-4-29
 *
 * @issues: https://github.com/humanhuang/hjs/issues
 */
var hjs,define;!function(e,t){function n(e,t,o,c){if(e=n.getPath(e),n.cache[e])return void(console&&console.log("module "+e+" is exists!"));var a=this;a.modulename=e,a.callback=o,a.depths=n.getDeps(t),a.needLoadDepth=a.depths.length,a.notices=(n.noticesCache[e]||{}).notices||[],a.exports={},a.execed=!1,a.use=c,a.init()}function o(){return h++}function c(e,t){t.toString().replace(/require\(\s*['"](.*)['"]\s*\)/gm,function(t,n){e.push(n)})}function a(e){return"[object Array]"==Object.prototype.toString.call(e)}function i(e){return e?a(e)?e:[e]:[]}function r(e,t){if(a(e))for(var n=0;n<e.length;n++)t(e[n],n);else for(var n in e)t(e[n],n)}function s(e){return"function"==typeof e}n.prototype={init:function(){var e=this;n.cache[e.modulename]=e,e.needLoadDepth?e.loadDepths():e.complete()},complete:function(){var e=this;e.status=n.loadStatus.LOADED,e.use&&e.exec(),e.noticeModule()},loadDepths:function(){var e=this;e.status=n.loadStatus.LOADING_DEPTHS,r(e.depths,function(t){n.load(t,e.modulename)})},receiveNotice:function(){--this.needLoadDepth||this.complete()},noticeModule:function(e){var t=this;if(e){if(t.status!=n.loadStatus.LOADED)return t.notices.push(e);n.cache[e].receiveNotice()}else r(t.notices,function(e){n.cache[e].receiveNotice()}),t.notices.length=0},exec:function(){var t=this;if(!t.execed&&(t.execed=!0,s(t.callback))){var o;(o=t.callback.call(e,n.require,t.exports,t))&&(t.exports=o)}}},n.loadStatus={LOADING_DEPTHS:1,LOADED:2},n.cache={},n.noticesCache={},n.loadingSource={},n.loadedSource={},n.init=function(e){!n.cache[e]&&new n(e)},n.require=function(e){var t=n.cache[n.getPath(e)];return t.exec(),t.exports},n.load=function(e,o){function c(){u||(!d.readyState||/loaded|complete/.test(d.readyState))&&(d.onload=d.onerror=d.onreadystatechange=null,n.loadedSource[r]=u=1,n.loaded(e))}var a,i;if(o){if(a=n.cache[e])return a.noticeModule(o);if(i=n.noticesCache[e])return i.notices.push(o);n.noticesCache[e]={notices:[o]}}var r=n.getFullPath(e);if(n.loadingSource[r])n.loadedSource[r]&&n.init(e);else{n.loadingSource[r]=1;var s=/\.css$/.test(e),u=0,l=+navigator.userAgent.replace(/.*(?:Apple|Android)WebKit\/(\d+).*/,"$1")<536,d=t.createElement(s?"link":"script"),h="onload"in d;if(s?(d.rel="stylesheet",d.type="text/css",d.href=r):(d.type="text/javascript",d.src=r),d.onload=d.onerror=d.onreadystatechange=c,d.charset=hjs.config().charset,t.getElementsByTagName("head")[0].appendChild(d),s&&(l||!h))var f=setTimeout(function(){return d.sheet?(clearTimeout(f),c()):void setTimeout(arguments.callee)})}},n.loaded=function(e){n.cache[e]||n.init(e)},n.getDeps=function(e){var t=[];return r(i(e),function(e){e=n.getPath(e),t.push(e)}),t},n.getPath=function(e){var t=e.length-1,n=hjs.config();return n.alias[e]&&(e=n.alias[e]),n.paths[e]&&(e=n.paths[e]),e=".js"===e.substring(t-2)||e.indexOf("?")>0||".css"===e.substring(t-3)||"/"===e.substring(t)?e:e+".js"};var u=/\/\.\//g,l=/\/[^/]+\/\.\.\//g,d=/[^:/]\/{2}/g;n.getFullPath=function(e){var t=hjs.config(),n=t.base;return n&&("/"!==n.substr(n.length-1)&&(n+="/"),e=n+e),e=e.replace(u,"/"),e=e.replace(l,"/"),e=e.replace(d,"/"),r(t.map,function(t){e=e.replace(t[0],t[1])}),e};var h=0;hjs=function(t,c){return n.cache[t]?n.cache[t].exports:void new n("_r_"+o(),t,function(){var o=[];r(i(t),function(e){o.push(n.require(e))}),s(c)&&c.apply(e,o)},!0)},hjs.version="1.0.0",hjs.module={cache:n.cache,noticesCache:n.noticesCache,loadingSource:n.loadingSource,loadedSource:n.loadedSource};var f={base:"",alias:{},paths:{},map:[],preload:[],debug:!0,charset:"utf-8"};hjs.config=function(e){return e?void r(e,function(e,t){a(e)?r(e,function(e,o){f[t].push(e),"preload"===t&&n.load(n.getPath(e))}):"object"==typeof e?r(e,function(e,n){f[t][n]=e}):f[t]=e}):f},define=function(e,t,o){"function"==typeof t&&(o=t,t=[]),t.length||c(t,o.toString()),new n(e,t,o)}}(window,document);

